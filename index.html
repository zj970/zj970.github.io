<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>落雪のBlog</title><meta name="author" content="zj970"><meta name="copyright" content="zj970"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="谢谢你在世界的角落找到我">
<meta property="og:type" content="website">
<meta property="og:title" content="落雪のBlog">
<meta property="og:url" content="https://www.serendipity.fit/index.html">
<meta property="og:site_name" content="落雪のBlog">
<meta property="og:description" content="谢谢你在世界的角落找到我">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/zj970/resource/personal/avatar.jpg">
<meta property="article:author" content="zj970">
<meta property="article:tag" content="落雪">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/zj970/resource/personal/avatar.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "WebSite",
  "name": "落雪のBlog",
  "alternateName": [
    "www.serendipity.fit"
  ],
  "url": "https://www.serendipity.fit/"
}</script><link rel="shortcut icon" href="https://gitee.com/zhou-jian1234/resource/raw/master/paper/favicon.webp"><link rel="canonical" href="https://www.serendipity.fit/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: true,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '落雪のBlog',
  isHighlightShrink: false,
  isToc: false,
  pageType: 'home'
}</script><meta name="generator" content="Hexo 6.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/zj970/resource/personal/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">26</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">4</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">5</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa fa-heartbeat"></i><span> 清单</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="page" id="body-wrap"><header class="full_page" id="page-header" style="background-image: url(https://gitee.com/zhou-jian1234/resource/raw/master/paper/15789130517090624.webp);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">落雪のBlog</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa fa-heartbeat"></i><span> 清单</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="site-info"><h1 id="site-title">落雪のBlog</h1><div id="site-subtitle"><span id="subtitle"></span></div></div><div id="scroll-down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout" id="content-inner"><div class="recent-posts nc" id="recent-posts"><div class="recent-post-items"><div class="recent-post-item"><div class="post_cover left"><a href="/2025/09/20/ArchLinux-AOSP-0/" title="AOSP 环境搭建"><img class="post-bg" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gitee.com/zhou-jian1234/resource/raw/master/paper/comics/17553037581602176.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="AOSP 环境搭建"></a></div><div class="recent-post-info"><a class="article-title" href="/2025/09/20/ArchLinux-AOSP-0/" title="AOSP 环境搭建">AOSP 环境搭建</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-09-20T14:41:49.000Z" title="发表于 2025-09-20 22:41:49">2025-09-20</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-09-20T20:58:14.162Z" title="更新于 2025-09-21 04:58:14">2025-09-21</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Android/">Android</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/aosp/">aosp</a></span></div><div class="content"> 前言 心不死则道不生，欲不灭则道不存，心不苦则智慧不开，身不苦则福禄不厚。    AOSP 源码环境AOSP(Android Open Source Project)是适用于不同规格设备的操作系统。点击跳转官方文档 一、目录结构AOSP 是一个巨大的工程，下面是目录结构说明： 123456789101112131415161718192021222324252627282930313233343536aosp (Android Open Source Project)  |--- .repo            // 由 `repo` 工具管理的版本库元数据目录。包含一个清单文件 (.xml) 来定义如何组合数百个 Git 仓库以构建一个完整的 Android 系统。  |--- abi              // 应用二进制接口（ABI）检查相关工具和配置，用于确保二进制兼容性。  |--- art              // Android Runtime (ART) 源码。负责将 DEX 字节码编译成本地机器码并执行，是现代 Android 应用运行的核心虚拟机...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2025/09/14/ArchLinuxSunshine/" title="ArchLinuxSunshine"><img class="post-bg" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gitee.com/zhou-jian1234/resource/raw/master/paper/comics/17165170649320832.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ArchLinuxSunshine"></a></div><div class="recent-post-info"><a class="article-title" href="/2025/09/14/ArchLinuxSunshine/" title="ArchLinuxSunshine">ArchLinuxSunshine</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-09-13T17:55:33.000Z" title="发表于 2025-09-14 01:55:33">2025-09-14</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-09-20T14:42:44.797Z" title="更新于 2025-09-20 22:42:44">2025-09-20</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Linux/">Linux</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/%E7%AC%94%E8%AE%B0/">笔记</a></span></div><div class="content">   前言 因为热爱，所以热爱    ArchLinux 扩展副屏&emsp;&emsp;为了体验鸿蒙系统上车华为平板，平时刷刷剧、看看书也是蛮不错的。最近总想着多屏幕耍电脑(之前买的DIY显示器坏了)，看着最近吃灰的平板，又是想着折腾 sunshine + moonlight (逛 github 时看到 MoonlightOH)。在 MoonlightOH 发现 Moonlight 已经适配上车，于是果断拿出平板开始折腾。 &emsp;&emsp;整个流程简单来说，识别额外的显示屏幕(诱骗器或软件模拟显示器)然后主机通过 sunshine 串流发送，客户端 moonlight 接收显示。当然其功能远远不止如此，不过对于我来说，作为副屏使用恰到好处(又省下一笔显示器费用😁)。 一、环境 Arch Linux  123456789101112131415161718192021neofetch                   -`                    zj970@HIGHFREEDOM                   .o+`              ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2025/06/04/Android%E6%B8%B2%E6%9F%93%E5%8E%9F%E7%90%86/" title="Android之渲染原理"><img class="post-bg" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gitee.com/zhou-jian1234/resource/raw/master/paper/comics/17367140004646272.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Android之渲染原理"></a></div><div class="recent-post-info"><a class="article-title" href="/2025/06/04/Android%E6%B8%B2%E6%9F%93%E5%8E%9F%E7%90%86/" title="Android之渲染原理">Android之渲染原理</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-06-03T16:33:51.000Z" title="发表于 2025-06-04 00:33:51">2025-06-04</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-09-13T18:18:59.670Z" title="更新于 2025-09-14 02:18:59">2025-09-14</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Android/">Android</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/%E7%AC%94%E8%AE%B0/">笔记</a></span></div><div class="content">  原文地址 kerli 看完不懂我吃：Android 渲染（显示）原理   &emsp;&emsp;本文中的所有内容大部分来源于网络资料，如有侵权请联系本人修改或删除，请大家多多支持原创!非常感谢！ 渲染框架图 通过对源码的解析，需要理解上图中的每个流程，从而了解整个渲染体系。比如屏幕刷新机制、SurfaceFlinger、硬件绘制、软件绘制、RenderThread等内容。 前置知识系统启动流程首先需要对 Android 启动流程进行了解，这里针对此内容模块进行介绍，详细可移步Android-14-源码分析之启动流程    init 进程在 Android 开机到 Linux 内核启动后，第一件事情就是启动 init 进程。它是第一用户空间进程，进程号为1。   SufaceFlinger 进程由 init 进程启动，职责包括“请求&#x2F;监听&#x2F;分发 vsync 信号”、”合成与送显“。   Zygote 进程由 init 进程启动，应用程序进程与 SystemServer 进程由它通过 fork 进行创建。同时，它创建了虚拟机，所以由它 fork 而来的应用程...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2025/05/25/Debug-JDB/" title="Debug 工具之 JDB"><img class="post-bg" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gitee.com/zhou-jian1234/resource/raw/master/paper/comics/17367140004646272.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Debug 工具之 JDB"></a></div><div class="recent-post-info"><a class="article-title" href="/2025/05/25/Debug-JDB/" title="Debug 工具之 JDB">Debug 工具之 JDB</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-05-25T11:24:20.000Z" title="发表于 2025-05-25 19:24:20">2025-05-25</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-05-25T12:53:02.344Z" title="更新于 2025-05-25 20:53:02">2025-05-25</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Android/">Android</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/%E7%AC%94%E8%AE%B0/">笔记</a></span></div><div class="content"> 前言 夏虫不可语于冰    AOSP 调试工具 JDP 使用文档一、概述JDP（Java Debugger Protocol）是一种基于 JDWP（Java Debug Wire Protocol） 的调试协议，广泛应用于调试 Android Framework 和 SystemServer 进程。JDP 可通过 jdb、Android Studio 或 IDEA 等调试工具连接至目标虚拟机，实现设置断点、单步调试、查看堆栈、变量等功能。 在 AOSP（Android Open Source Project）开发中，利用 JDP 可以定位 SystemServer 中服务的初始化问题、Binder 调用异常等系统级问题。  二、JDP&#x2F;JDWP 调试前提 已开启 ro.debuggable=1。 目标进程支持 JDWP（SystemServer 默认支持）。 可通过 ADB 通信。 主机和设备间端口转发已配置。   三、连接调试步骤（以 SystemServer 为例）步骤 1：确保设备开启调试模式12adb rootadb remount  确认 ro.debugg...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2024/12/31/%E7%A6%BB%E5%88%AB2024/" title="离别2024"><img class="post-bg" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gitee.com/zhou-jian1234/resource/raw/master/paper/comics/17367140004646272.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="离别2024"></a></div><div class="recent-post-info"><a class="article-title" href="/2024/12/31/%E7%A6%BB%E5%88%AB2024/" title="离别2024">离别2024</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-12-31T15:59:59.000Z" title="发表于 2024-12-31 23:59:59">2024-12-31</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-09-14T16:20:51.019Z" title="更新于 2025-09-15 00:20:51">2025-09-15</time></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/%E4%BA%BA%E7%94%9F/">人生</a></span></div><div class="content"> 前言 烟火人间，各有遗憾。    生活&emsp;&emsp;过得并不好，相当糟糕。&emsp;&emsp;今年是颠沛流离的一年，过年完3月来到深圳，没多久来到重庆，后面离开重庆去贵阳呆了一个星期，8月7日又回到了深圳。期间差点去江苏、宁夏。&emsp;&emsp;体重，有段日子瘦了17斤，后面在深圳又涨回来还胖了10斤，现在已经190了。   学习&emsp;&emsp;学习这件事，我没有做好坚持。&emsp;&emsp;打了2个月的英语单词卡，后面丢之脑后，不管什么理由，都是借口。&emsp;&emsp;LeetCode的打卡，github 的打卡，我也没有坚持。&emsp;&emsp;看了几个月的网工，自己没刷题，没继续复习下去，报了名却没有去参加考试。&emsp;&emsp;唯一值得称赞的是，敲代码这件事比去年多了很多，也专业了很多。在Android，后端，都有输出产品，也写了几篇文章。 工作&emsp;&emsp;工作变动比较大，先从老东家离开，在重庆工作了一段时间，最终来到了HCN。&emsp;&emsp;在 FS，虽然工作时间很短，但做了很多事情，我的组长，周哥教...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2024/11/17/%E8%91%AC%E9%80%81%E7%9A%84%E8%8A%99%E8%8E%89%E8%8E%B2/" title="葬送的芙莉莲"><img class="post-bg" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gitee.com/zhou-jian1234/resource/raw/master/paper/comics/buried_flillian.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="葬送的芙莉莲"></a></div><div class="recent-post-info"><a class="article-title" href="/2024/11/17/%E8%91%AC%E9%80%81%E7%9A%84%E8%8A%99%E8%8E%89%E8%8E%B2/" title="葬送的芙莉莲">葬送的芙莉莲</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-11-17T11:57:06.000Z" title="发表于 2024-11-17 19:57:06">2024-11-17</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-09-14T16:18:13.934Z" title="更新于 2025-09-15 00:18:13">2025-09-15</time></span></div><div class="content"> 前言 待我翻过这座山，再与你讲我的不堪        偏向-陈子晴       这并不像 道听途说的假象 也无妨 让回忆肆意增长 不谦让 争了个理所应当 怎么样 落一个两败俱伤 你可以说我性格张扬 全都一样 迁就或推推搡搡 别伪装 一副道貌岸然的模样 快点忘 自欺欺人的扫荡 称不上 大方或性格张扬 为何会两败俱伤 我嫌弃你的偏向 会让我觉得有点丧 避开你流露出的锋芒 别跟我斤斤计较 算旧账 我嫌弃你的偏向 瞎话编得冠冕堂皇 掩饰不了你做的假象 像被隐形绳子捆绑 逞着强 全都一样迁就或推推搡搡 别伪装 一副道貌岸然的模样 快点忘 自欺欺人的扫荡 称不上 大方或性格张扬 为何会两败俱伤 我嫌弃你的偏向 会让我觉得有点丧 避开你流露出的锋芒 别跟我斤斤计较 算旧账 我嫌弃你的偏向 瞎话编得冠冕堂皇 掩饰不了你做的假象 像被隐形绳子捆绑 逞着强  </div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2024/10/03/%E5%A4%9C%E7%94%9F%E6%B4%BB/" title="夜生活"><img class="post-bg" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gitee.com/zhou-jian1234/resource/raw/master/paper/life/chongqing_moon.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="夜生活"></a></div><div class="recent-post-info"><a class="article-title" href="/2024/10/03/%E5%A4%9C%E7%94%9F%E6%B4%BB/" title="夜生活">夜生活</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-10-02T19:11:31.000Z" title="发表于 2024-10-03 03:11:31">2024-10-03</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-09-14T16:21:42.099Z" title="更新于 2025-09-15 00:21:42">2025-09-15</time></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/%E4%BA%BA%E7%94%9F/">人生</a></span></div><div class="content">   前言 他教我收余恨，免娇气，且自新，改性情，休恋逝水，苦海回身，早悟兰因    &emsp;&emsp;年年岁岁，岁岁年年，每当有了闲暇时间，生活作息就会紊乱，常常一个人半夜不睡觉，不知道在干什么。        &emsp;&emsp;以前不理解大人们为什么会失眠，觉得世上哪有过不去的坎，后来我也变成了这样的人。从什么时候开始的呢？大概是从疫情那年开始的，以前也会熬夜，但不至于那么凶。熬夜是不好的，时常肝痛和心悸总是提醒着我。但我一到晚上就不想睡觉，也睡不着。最近反复刷了一下”老友赛“的辩论赛《熬夜是现代人的病还是药》，其中有句话深深刺中了我：人为什么要喝酒？因为不喝酒的时候不快乐，你说我为什么要熬夜，因为我的生活是空虚。那我问你，你为什么不在白天去填补你的空虚呢？因为很简单，因为白天的时间不属于你…..这一切的原因都来自于我没有办法找到我的意义，我不得不用这种办法来延缓我的痛苦。       &emsp;&emsp;白天于我，是让我不得不带上面具，去面对生活中的糟心事儿的痛苦。而晚上于我是可以躺在床上，可以什么都不想，也可以什么都想的自由。我能自由地支配我的时间，享受夜...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2024/08/17/Android%E4%B9%8BApk%E4%BC%98%E5%8C%96/" title="Android之Apk优化"><img class="post-bg" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gitee.com/zhou-jian1234/resource/raw/master/paper/comics/17367140004646272.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Android之Apk优化"></a></div><div class="recent-post-info"><a class="article-title" href="/2024/08/17/Android%E4%B9%8BApk%E4%BC%98%E5%8C%96/" title="Android之Apk优化">Android之Apk优化</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-08-17T02:13:16.000Z" title="发表于 2024-08-17 10:13:16">2024-08-17</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-09-13T18:19:08.061Z" title="更新于 2025-09-14 02:19:08">2025-09-14</time></span></div><div class="content">APK 瘦身指南前言 千里之堤，溃于蚁穴  快速诊断始终使用 Android Studio 中的 APK Analyzer 对生成的 APK 进行分析处理对比(Build -&gt; Analyzer apk.. 或者直接使用 Android Studio 打开 apk 文件)，一个 apk 文件大致内容如下：     文件 说明 扩展    lib so文件，不同的cpu架构 可以针对不同架构平台进行拆分打包或者使用兼容库   res 编译后的资源文件，drawable、layout等 优化的重点   assets 应用程序的资源、字体、音视频文件等 可使用工具进行优化   classes(n).dex dx编译后的java文件 使用混淆进行优化   META-INF 签名信息相关 ——   resources.arsc 二进制资源文件 资源的映射表，可以查询任意类型的资源id   kotlin 编译后的kotlin文件 ——   AndroiidManifest.xml 清单文件 ——   优化方向总共分为两部分，资源优化(本文重点)和代码优化(进阶) 资源优化一、 移除无用...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2024/05/16/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7%E9%85%8D%E7%BD%AE/" title="开发工具"><img class="post-bg" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gitee.com/zhou-jian1234/resource/raw/master/paper/comics/17367140004646272.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="开发工具"></a></div><div class="recent-post-info"><a class="article-title" href="/2024/05/16/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7%E9%85%8D%E7%BD%AE/" title="开发工具">开发工具</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-05-16T14:21:49.000Z" title="发表于 2024-05-16 22:21:49">2024-05-16</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-09-20T19:52:21.485Z" title="更新于 2025-09-21 03:52:21">2025-09-21</time></span></div><div class="content">通用配置JVM 配置123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136# 初始堆内存大小：设置为16GB-Xms16g# 最大堆内存大小：调整为26GB（解决压缩指针限制）-Xmx26g# 元空间最大大小：1GB-XX:MaxMetaspaceSize=1024m# JIT编译代码缓存区大小：1GB-XX:ReservedCodeCacheSize=1024m# 使用G1垃圾收集器-XX:+UseG1GC# 设置G1GC最大暂停时间目标：1...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2024/03/11/Handler%E9%80%9A%E4%BF%A1%E6%9C%BA%E5%88%B6/" title="Handler通信机制"><img class="post-bg" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gitee.com/zhou-jian1234/resource/raw/master/paper/comics/17367140004646272.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Handler通信机制"></a></div><div class="recent-post-info"><a class="article-title" href="/2024/03/11/Handler%E9%80%9A%E4%BF%A1%E6%9C%BA%E5%88%B6/" title="Handler通信机制">Handler通信机制</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-03-11T15:38:22.000Z" title="发表于 2024-03-11 23:38:22">2024-03-11</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-03-13T14:18:11.477Z" title="更新于 2024-03-13 22:18:11">2024-03-13</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Android/">Android</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/%E7%AC%94%E8%AE%B0/">笔记</a></span></div><div class="content"> 前言 喜欢就争取 得到就珍惜 错过就忘记      参考博客 Carson带你学Android-Android异步通信：手把手教你使用Handler消息传递机制(含实例讲解） 奶盖-面试被问Handler 的通信机制的背后的原理是什么？95%的人都没完全理解 Android之Handler消息机制——深入理解 Looper、Handler、Message、MessageQueue 临时抱佛脚:IdleHandler的原理分析和妙用 Handler同步屏障机制的原理和使用场景  &emsp;&emsp;本文中的所有内容大部分来源于网络资料，如有侵权请联系本人修改或删除，请大家多多支持原创!非常感谢！ HandlerHandler机制简介&emsp;&emsp;Android的UI框架基于事件驱动，所有与界面相关的操作必须在主线程(也称为UI线程)中执行。这是由于Android的UI框架不是线程安全的，即多个线程同时操作UI可能引发各种问题，例如UI元素的状态不一致、布局错乱、甚至崩溃等。故多线程可并发操作UI组件，则出现了Handler。Handler是一套Android消息传递...</div></div></div></div><nav id="pagination"><div class="pagination"><span class="page-number current">1</span><a class="page-number" href="/page/2/#content-inner">2</a><a class="page-number" href="/page/3/#content-inner">3</a><a class="extend next" rel="next" href="/page/2/#content-inner"><i class="fas fa-chevron-right fa-fw"></i></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/zj970/resource/personal/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">zj970</div><div class="author-info-description">谢谢你在世界的角落找到我</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">26</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">4</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">5</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/zj970"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">外向是生活所需，孤独是自我享受</div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/09/20/ArchLinux-AOSP-0/" title="AOSP 环境搭建"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gitee.com/zhou-jian1234/resource/raw/master/paper/comics/17553037581602176.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="AOSP 环境搭建"/></a><div class="content"><a class="title" href="/2025/09/20/ArchLinux-AOSP-0/" title="AOSP 环境搭建">AOSP 环境搭建</a><time datetime="2025-09-20T14:41:49.000Z" title="发表于 2025-09-20 22:41:49">2025-09-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/09/14/ArchLinuxSunshine/" title="ArchLinuxSunshine"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gitee.com/zhou-jian1234/resource/raw/master/paper/comics/17165170649320832.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ArchLinuxSunshine"/></a><div class="content"><a class="title" href="/2025/09/14/ArchLinuxSunshine/" title="ArchLinuxSunshine">ArchLinuxSunshine</a><time datetime="2025-09-13T17:55:33.000Z" title="发表于 2025-09-14 01:55:33">2025-09-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/06/04/Android%E6%B8%B2%E6%9F%93%E5%8E%9F%E7%90%86/" title="Android之渲染原理"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gitee.com/zhou-jian1234/resource/raw/master/paper/comics/17367140004646272.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Android之渲染原理"/></a><div class="content"><a class="title" href="/2025/06/04/Android%E6%B8%B2%E6%9F%93%E5%8E%9F%E7%90%86/" title="Android之渲染原理">Android之渲染原理</a><time datetime="2025-06-03T16:33:51.000Z" title="发表于 2025-06-04 00:33:51">2025-06-04</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/05/25/Debug-JDB/" title="Debug 工具之 JDB"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gitee.com/zhou-jian1234/resource/raw/master/paper/comics/17367140004646272.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Debug 工具之 JDB"/></a><div class="content"><a class="title" href="/2025/05/25/Debug-JDB/" title="Debug 工具之 JDB">Debug 工具之 JDB</a><time datetime="2025-05-25T11:24:20.000Z" title="发表于 2025-05-25 19:24:20">2025-05-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/12/31/%E7%A6%BB%E5%88%AB2024/" title="离别2024"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gitee.com/zhou-jian1234/resource/raw/master/paper/comics/17367140004646272.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="离别2024"/></a><div class="content"><a class="title" href="/2024/12/31/%E7%A6%BB%E5%88%AB2024/" title="离别2024">离别2024</a><time datetime="2024-12-31T15:59:59.000Z" title="发表于 2024-12-31 23:59:59">2024-12-31</time></div></div></div></div><div class="card-widget card-categories"><div class="item-headline">
            <i class="fas fa-folder-open"></i>
            <span>分类</span>
            
          </div>
          <ul class="card-category-list" id="aside-cat-list">
            <li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Android/"><span class="card-category-list-name">Android</span><span class="card-category-list-count">13</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/AndroidTV/"><span class="card-category-list-name">AndroidTV</span><span class="card-category-list-count">2</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Framework/"><span class="card-category-list-name">Framework</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Linux/"><span class="card-category-list-name">Linux</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Unity/"><span class="card-category-list-name">Unity</span><span class="card-category-list-count">2</span></a></li>
          </ul></div><div class="card-widget card-tags"><div class="item-headline"><i class="fas fa-tags"></i><span>标签</span></div><div class="card-tag-cloud"><a href="/tags/aosp/" style="font-size: 1.1em; color: #999">aosp</a> <a href="/tags/%E5%8E%9F%E5%88%9B/" style="font-size: 1.1em; color: #999">原创</a> <a href="/tags/%E4%BA%BA%E7%94%9F/" style="font-size: 1.3em; color: #99a1ac">人生</a> <a href="/tags/%E7%AC%94%E8%AE%B0/" style="font-size: 1.5em; color: #99a9bf">笔记</a></div></div><div class="card-widget card-archives">
    <div class="item-headline">
      <i class="fas fa-archive"></i>
      <span>归档</span>
      <a class="card-more-btn" href="/archives/"
            title="查看更多">
            <i class="fas fa-angle-right"></i>
          </a>
    </div>
  
    <ul class="card-archive-list">
      
        <li class="card-archive-list-item">
          <a class="card-archive-list-link" href="/archives/2025/09/">
            <span class="card-archive-list-date">
              九月 2025
            </span>
            <span class="card-archive-list-count">2</span>
          </a>
        </li>
      
        <li class="card-archive-list-item">
          <a class="card-archive-list-link" href="/archives/2025/06/">
            <span class="card-archive-list-date">
              六月 2025
            </span>
            <span class="card-archive-list-count">1</span>
          </a>
        </li>
      
        <li class="card-archive-list-item">
          <a class="card-archive-list-link" href="/archives/2025/05/">
            <span class="card-archive-list-date">
              五月 2025
            </span>
            <span class="card-archive-list-count">1</span>
          </a>
        </li>
      
        <li class="card-archive-list-item">
          <a class="card-archive-list-link" href="/archives/2024/12/">
            <span class="card-archive-list-date">
              十二月 2024
            </span>
            <span class="card-archive-list-count">1</span>
          </a>
        </li>
      
        <li class="card-archive-list-item">
          <a class="card-archive-list-link" href="/archives/2024/11/">
            <span class="card-archive-list-date">
              十一月 2024
            </span>
            <span class="card-archive-list-count">1</span>
          </a>
        </li>
      
        <li class="card-archive-list-item">
          <a class="card-archive-list-link" href="/archives/2024/10/">
            <span class="card-archive-list-date">
              十月 2024
            </span>
            <span class="card-archive-list-count">1</span>
          </a>
        </li>
      
        <li class="card-archive-list-item">
          <a class="card-archive-list-link" href="/archives/2024/08/">
            <span class="card-archive-list-date">
              八月 2024
            </span>
            <span class="card-archive-list-count">1</span>
          </a>
        </li>
      
        <li class="card-archive-list-item">
          <a class="card-archive-list-link" href="/archives/2024/05/">
            <span class="card-archive-list-date">
              五月 2024
            </span>
            <span class="card-archive-list-count">1</span>
          </a>
        </li>
      
    </ul>
  </div><div class="card-widget card-webinfo"><div class="item-headline"><i class="fas fa-chart-line"></i><span>网站信息</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">文章数目 :</div><div class="item-count">26</div></div><div class="webinfo-item"><div class="item-name">本站访客数 :</div><div class="item-count" id="busuanzi_value_site_uv"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">本站总浏览量 :</div><div class="item-count" id="busuanzi_value_site_pv"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">最后更新时间 :</div><div class="item-count" id="last-push-date" data-lastPushDate="2025-09-20T21:02:21.015Z"><i class="fa-solid fa-spinner fa-spin"></i></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2020 - 2025 By zj970</span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><div class="js-pjax"><script>window.typedJSFn = {
  init: str => {
    window.typed = new Typed('#subtitle', Object.assign({
      strings: str,
      startDelay: 300,
      typeSpeed: 150,
      loop: true,
      backSpeed: 50,
    }, null))
  },
  run: subtitleType => {
    if (true) {
      if (typeof Typed === 'function') {
        subtitleType()
      } else {
        btf.getScript('https://cdn.jsdelivr.net/npm/typed.js/dist/typed.umd.min.js').then(subtitleType)
      }
    } else {
      subtitleType()
    }
  },
  processSubtitle: (content, extraContents = []) => {
    if (true) {
      const sub = ["Never put off till tomorrow what you can do today"].slice()

      if (extraContents.length > 0) {
        sub.unshift(...extraContents)
      }

      if (typeof content === 'string') {
        sub.unshift(content)
      } else if (Array.isArray(content)) {
        sub.unshift(...content)
      }

      sub.length > 0 && typedJSFn.init(sub)
    } else {
      document.getElementById('subtitle').textContent = typeof content === 'string' ? content :
        (Array.isArray(content) && content.length > 0 ? content[0] : '')
    }
  }
}
btf.addGlobalFn('pjaxSendOnce', () => { typed.destroy() }, 'typedDestroy')
</script><script>function subtitleType () {
  fetch('https://v1.hitokoto.cn')
    .then(response => response.json())
    .then(data => {
      const from = '出自 ' + data.from
      typedJSFn.processSubtitle(data.hitokoto, [from])
    })
    .catch(err => {
      console.error('Failed to get the Hitokoto API:', err)
      typedJSFn.processSubtitle(["Never put off till tomorrow what you can do today"])
    })
}
typedJSFn.run(subtitleType)
</script><script>(() => {
  const runMermaid = ele => {
    window.loadMermaid = true
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'forest'

    ele.forEach((item, index) => {
      const mermaidSrc = item.firstElementChild
      const mermaidThemeConfig = `%%{init:{ 'theme':'${theme}'}}%%\n`
      const mermaidID = `mermaid-${index}`
      const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent

      const renderFn = mermaid.render(mermaidID, mermaidDefinition)
      const renderMermaid = svg => {
        mermaidSrc.insertAdjacentHTML('afterend', svg)
      }

      // mermaid v9 and v10 compatibility
      typeof renderFn === 'string' ? renderMermaid(renderFn) : renderFn.then(({ svg }) => renderMermaid(svg))
    })
  }

  const codeToMermaid = () => {
    const codeMermaidEle = document.querySelectorAll('pre > code.mermaid')
    if (codeMermaidEle.length === 0) return

    codeMermaidEle.forEach(ele => {
      const preEle = document.createElement('pre')
      preEle.className = 'mermaid-src'
      preEle.hidden = true
      preEle.textContent = ele.textContent
      const newEle = document.createElement('div')
      newEle.className = 'mermaid-wrap'
      newEle.appendChild(preEle)
      ele.parentNode.replaceWith(newEle)
    })
  }

  const loadMermaid = () => {
    if (false) codeToMermaid()
    const $mermaid = document.querySelectorAll('#article-container .mermaid-wrap')
    if ($mermaid.length === 0) return

    const runMermaidFn = () => runMermaid($mermaid)
    btf.addGlobalFn('themeChange', runMermaidFn, 'mermaid')
    window.loadMermaid ? runMermaidFn() : btf.getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaidFn)
  }

  btf.addGlobalFn('encrypt', loadMermaid, 'mermaid')
  window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
})()</script></div><script defer="defer" id="fluttering_ribbon" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-fluttering-ribbon.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>